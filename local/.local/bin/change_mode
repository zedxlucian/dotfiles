#!/bin/sh

ALWAYS="
Xft.autohint: 0
Xft.antialias: 1
Xft.hinting: true
Xft.hintstyle: hintslight
Xft.dpi: 91
Xft.rgba: rgb
Xft.lcdfilter: lcddefault
/* DMENU */
dmenu.font:SFMono Nerd Font Mono:style=Regular:size=12:antialias=true:autohint=true

/* ST */
st.font:SFMono Nerd Font Mono:style=Regular:size=10:antialias=true:autohint=true
st.cwscale: 1.00
st.chscale: 1.05


/* ! Dracula Xresources palette */
*.color0: #000000
*.color1: #b5407b
*.color2: #7bb540
*.color3: #b57b40
*.color4: #407bb5
*.color5: #7b40b5
*.color6: #40b57b
*.color7: #f8f8f8

*.color8: #737373
*.color9: #cd73a0
*.color10: #a0cd73
*.color11: #cda073
*.color12: #73a0cd
*.color13: #a073cd
*.color14: #73cda0
*.color15: #ffffff

dwm.topbar: 1
dwm.borderpx: 2
dwm.barborder: 2

dmenu.borderpx: 2
"

DARK_MODE="
/* DARK MODE */
dwm.normbgcolor: #000000
dwm.normfgcolor: #ffab91
dwm.normbordercolor: #000000

dwm.selfgcolor: #000000
dwm.selbgcolor: #ffab91
dwm.selbordercolor: #ffab91

dmenu.background: #000000
dmenu.foreground: #ffffff
dmenu.selbackground: #ffffff
dmenu.selforeground:#000000

dmenu.highlightbackground: #000000
dmenu.higlightselbackground: #ffffff

dmenu.highlightforeground: #FF92D0
dmenu.highlightselforeground: #005577

dmenu.outbackground:#ffffff
dmenu.outforeground:#000000

*.foreground: #ffffff
*.background: #000000
st.cursorColor: #ffffff
"

LIGHT_MODE="
/* LIGHT MODE */
dwm.normbgcolor: #ffffff
dwm.normfgcolor: #ffab91
dwm.normbordercolor: #e0e0e0

dwm.selbgcolor: #e0e0e0
dwm.selfgcolor: #ffab91
dwm.selbordercolor: #ffab91

dmenu.background: #ffffff
dmenu.foreground: #000000
dmenu.selbackground: #000000
dmenu.selforeground:#ffffff

dmenu.highlightbackground: #ffffff
dmenu.higlightselbackground: #000000

dmenu.highlightforeground: #005577
dmenu.highlightselforeground:#FF92D0

dmenu.outbackground:#ffffff
dmenu.outforeground:#000000

*.foreground: #000000
*.background: #ffffff
st.cursorColor: #000000
"

if [ -f $1 ]
then

	PROMPT="$(echo -e "Light\nDark" | dmenu -p "Change mode to:")"

	if [ "$PROMPT" = "Light" ]
	then
		CHOOSED_CONFIG+="$ALWAYS $LIGHT_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st)

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme sol"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"sol"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Arc"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"WhiteSur-light"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc

	elif [ "$PROMPT" = "Dark" ]
	then
		CHOOSED_CONFIG+="$ALWAYS $DARK_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st)

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme minimalist"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"minimalist"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Shades-of-gray"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Whitesur-dark"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc

	fi

else

	if [ "$1" = "Light" -o "$1" = "light" ] ; then
		CHOOSED_CONFIG+="$ALWAYS $LIGHT_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st)

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme sol"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"sol"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Arc"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Whitesur-light"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc

	elif [ "$1" = "Dark" -o "$1" = "dark" ] ; then
		CHOOSED_CONFIG+="$ALWAYS $DARK_MODE"
		echo "$CHOOSED_CONFIG" > $HOME/.config/X11/Xresources &&
		xrdb -merge $HOME/.config/X11/Xresources &&
		dwmc reload &&
		kill -s USR1 $(pidof st)

		if ls /tmp/nvimsocket-* 1> /dev/null 2>&1; then
			cmdvim "AirlineTheme minimalist"
		fi

		sed -i 's/^\(let g:airline_theme\s*=\s*\).*$/\1"minimalist"/' $HOME/.config/nvim/init.vim

		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Shades-of-gray"/' $HOME/.config/gtk-2.0/gtkrc-2.0
		sed -i 's/^\(gtk-theme-name \s*=\s*\).*$/\1"Whitesur-dark"/' $HOME/.config/gtk-3.0/settings.ini
		genzathurarc > ~/.config/zathura/zathurarc

	elif [ "$1" = "toggle" -o "$1" = "Toggle" ] ; then
		if grep -q "DARK MODE" $HOME/.config/X11/Xresources
		then
			change_mode light
		else
			change_mode dark
		fi
	fi
fi
