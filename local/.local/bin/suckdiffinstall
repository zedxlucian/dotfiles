#!/usr/bin/env bash

git checkout master &&
dotfiles="/home/lydien/.dotfiles/local/.local/src/suckless"
project=$(basename "$(pwd)")
diffdir="${dotfiles}/${project}_diffs"
make clean && rm -f config.h && git reset --hard origin/master &&
for branch in $(git for-each-ref --format='%(refname)' refs/heads/ | cut -d'/' -f3); do
	if [ "$branch" != "master" ];then
		git checkout "$branch"
		git apply "$diffdir/$branch.diff"
		git add -A
		git commit -m "$branch"
	fi
done
